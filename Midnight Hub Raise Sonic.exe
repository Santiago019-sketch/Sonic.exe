if not game:IsLoaded() then
    game.Loaded:Wait()
end

local OrionLib = loadstring(game:HttpGet(('https://raw.githubusercontent.com/shlexware/Orion/main/source')))()
local Window = OrionLib:MakeWindow({
    Name = "Midnight Hub | Raise a Sonic",
    HidePremium = false,
    SaveConfig = false,
    IntroEnabled = true,
    IntroText = "Welcome to Midnight Hub."
})

-- Services
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local Players = game:GetService("Players")
local LocalPlayer = Players.LocalPlayer

-- Anti-AFK
if getconnections then
    for _, v in pairs(getconnections(LocalPlayer.Idled)) do
        v:Disable()
    end
end

-- Set WalkSpeed
LocalPlayer.Character:FindFirstChild("Humanoid").WalkSpeed = 50

-- Create Tabs
local MainTab = Window:MakeTab({
    Name = "Main",
    Icon = "rbxassetid://4483345998"
})

local CreditsTab = Window:MakeTab({
    Name = "Credits",
    Icon = "rbxassetid://6961018885"
})

-- Create Section
local FarmingSection = MainTab:AddSection({
    Name = "Farming"
})

-- Welcome Notification
OrionLib:MakeNotification({
    Name = "Midnight Hub",
    Content = "Welcome to Midnight Hub.",
    Image = "rbxassetid://4370317928",
    Time = 5
})

-- Variables
getgenv().Delay = 0.1
getgenv().AutoClick = false
getgenv().AutoCollect = false
getgenv().AutoBuyFood = false
getgenv().AutoGetRent = false

-- Delay Setting
FarmingSection:AddTextbox({
    Name = "Click & Collect Delay",
    Default = "0.1",
    TextDisappear = true,
    Callback = function(Value)
        getgenv().Delay = tonumber(Value) or 0.1
    end
})

-- Auto Click Toggle
FarmingSection:AddToggle({
    Name = "Auto Click Sonic",
    Default = false,
    Callback = function(Value)
        getgenv().AutoClick = Value
        while getgenv().AutoClick do 
            task.wait(getgenv().Delay)
            local Sonic = workspace:FindFirstChild("Sonic")
            if Sonic and Sonic:FindFirstChild("Sonic") then
                fireclickdetector(Sonic.Sonic.ClickDetector)
            end
        end
    end
})

-- Auto Collect Toggle
FarmingSection:AddToggle({
    Name = "Auto Collect Rings",
    Default = false,
    Callback = function(Value)
        getgenv().AutoCollect = Value
        while getgenv().AutoCollect do 
            task.wait(getgenv().Delay)
            for _, v in next, workspace:GetDescendants() do
                if v.Name == "Ring" and v then
                    firetouchinterest(LocalPlayer.Character.Head, v, 0)
                    firetouchinterest(LocalPlayer.Character.Head, v, 1)
                end
            end
        end
    end
})

-- Auto Buy Food Toggle
FarmingSection:AddToggle({
    Name = "Auto Buy Food",
    Default = false,
    Callback = function(Value)
        getgenv().AutoBuyFood = Value
        while getgenv().AutoBuyFood do 
            task.wait(1)
            local Food = workspace:FindFirstChild("Food")
            if Food and not Food.Full.Value then
                ReplicatedStorage.Buy:FireServer("Sonic Food")
            end
        end
    end
})

-- Auto Get Rent Toggle
FarmingSection:AddToggle({
    Name = "Auto Get Rent",
    Default = false,
    Callback = function(Value)
        getgenv().AutoGetRent = Value
        while getgenv().AutoGetRent do 
            task.wait(1)
            if ReplicatedStorage.CanGetRent.Value and ReplicatedStorage.SonicEXE.Value then
                ReplicatedStorage.RentEvent:FireServer("Get")
            end
        end
    end
})

-- Credits
CreditsTab:AddLabel("Scripted by Midnight Team")
CreditsTab:AddLabel("UI Library by shlex")

CreditsTab:AddParagraph("Info", "Script changelogs at our Discord Server. If you find any bugs, inform us.")

CreditsTab:AddButton({
    Name = "Copy Discord Invite",
    Callback = function()
        setclipboard("https://discord.gg/midnighthub")
        OrionLib:MakeNotification({
            Name = "Midnight Hub",
            Content = "Copied Discord Server Invite to Clipboard.",
            Image = "rbxassetid://4370317928",
            Time = 2
        })
    end
})

-- Keybind
CreditsTab:AddBind({
    Name = "UI Toggle Keybind",
    Default = Enum.KeyCode.RightShift,
    Hold = false,
    Callback = function()
    end
})

OrionLib:Init()
